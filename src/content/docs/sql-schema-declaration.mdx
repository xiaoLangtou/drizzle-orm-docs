import Tab from '@mdx/Tab.astro';
import Tabs from '@mdx/Tabs.astro';
import Callout from '@mdx/Callout.astro';
import SimpleLinkCards from '@mdx/SimpleLinkCards.astro';
import CodeTabs from "@mdx/CodeTabs.astro";
import Section from '@mdx/Section.astro';
import Flex from "@mdx/Flex.astro"
import LinksList from "@mdx/LinksList.astro"

# Drizzle Schema

Drizzle å…è®¸ä½ ä½¿ç”¨ TypeScript å®šä¹‰æ•°æ®åº“ schemaï¼Œæ”¯æŒåº•å±‚æ•°æ®åº“çš„å„ç§æ¨¡å‹å’Œå±æ€§ã€‚
å½“ä½ å®šä¹‰ schema æ—¶ï¼Œå®ƒå°†ä½œä¸ºåç»­ä¿®æ”¹æŸ¥è¯¢ï¼ˆä½¿ç”¨ Drizzle-ORMï¼‰å’Œè¿ç§»ï¼ˆä½¿ç”¨ Drizzle-Kitï¼‰çš„çœŸå®æ¥æºã€‚

<Callout> 
å¦‚æœä½ æ­£åœ¨ä½¿ç”¨ Drizzle-Kit è¿›è¡Œè¿ç§»è¿‡ç¨‹ï¼Œè¯·ç¡®ä¿å¯¼å‡º schema æ–‡ä»¶ä¸­å®šä¹‰çš„æ‰€æœ‰æ¨¡å‹ï¼Œä»¥ä¾¿ Drizzle-Kit å¯ä»¥å¯¼å…¥å®ƒä»¬å¹¶åœ¨è¿ç§»å·®å¼‚è¿‡ç¨‹ä¸­ä½¿ç”¨å®ƒä»¬ã€‚
</Callout>

## ç»„ç»‡ä½ çš„ schema æ–‡ä»¶
ä½ å¯ä»¥ç›´æ¥åœ¨ TypeScript ä¸­å£°æ˜ä½ çš„ SQL schemaï¼Œå¯ä»¥æ”¾åœ¨å•ä¸ª `schema.ts` æ–‡ä»¶ä¸­ï¼Œ
ä¹Ÿå¯ä»¥åˆ†æ•£åœ¨å¤šä¸ªæ–‡ä»¶ä¸­ â€” å®Œå…¨ç”±ä½ å†³å®šï¼Œæ‹¥æœ‰å……åˆ†çš„è‡ªç”±ï¼

#### å•æ–‡ä»¶ Schema
ä½¿ç”¨ Drizzle å£°æ˜ schema æœ€å¸¸è§çš„æ–¹å¼æ˜¯å°†æ‰€æœ‰è¡¨æ”¾åœ¨ä¸€ä¸ª `schema.ts` æ–‡ä»¶ä¸­ã€‚

> æ³¨æ„ï¼šä½ å¯ä»¥éšæ„å‘½åä½ çš„ schema æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼Œå®ƒå¯ä»¥æ˜¯ `models.ts`ï¼Œæˆ–è€…å…¶ä»–åç§°ã€‚

å¦‚æœä½ çš„è¡¨æ¨¡å‹å®šä¹‰ä¸æ˜¯å¤ªå¤šï¼Œæˆ–è€…ä½ ä¸ä»‹æ„å°†å®ƒä»¬éƒ½æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œè¿™ç§æ–¹æ³•å°±å¾ˆåˆé€‚ã€‚

ç¤ºä¾‹ï¼š
    ```plaintext
ğŸ“¦ <project root>
 â”” ğŸ“‚ src
    â”” ğŸ“‚ db
       â”” ğŸ“œ schema.ts
    ```

åœ¨ `drizzle.config.ts` æ–‡ä»¶ä¸­ï¼Œä½ éœ€è¦æŒ‡å®š schema æ–‡ä»¶çš„è·¯å¾„ã€‚é€šè¿‡è¿™ä¸ªé…ç½®ï¼ŒDrizzle å°†
ä» `schema.ts` æ–‡ä»¶ä¸­è¯»å–ä¿¡æ¯ï¼Œå¹¶åœ¨è¿ç§»ç”Ÿæˆè¿‡ç¨‹ä¸­ä½¿ç”¨è¿™äº›ä¿¡æ¯ã€‚æœ‰å…³ `drizzle.config.ts` æ–‡ä»¶
å’Œ Drizzle è¿ç§»çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ï¼š[é“¾æ¥](/docs/drizzle-config-file)
```ts
import { defineConfig } from "drizzle-kit";

export default defineConfig({
  dialect: 'postgresql', // 'mysql' | 'sqlite' | 'turso'
  schema: './src/db/schema.ts'
})
```

#### å¤šæ–‡ä»¶ Schema

ä½ å¯ä»¥å°† Drizzle æ¨¡å‹ï¼ˆå¦‚è¡¨ã€æšä¸¾ã€åºåˆ—ç­‰ï¼‰ä¸ä»…æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œè¿˜å¯ä»¥æ”¾åœ¨ä»»ä½•ä½ å–œæ¬¢çš„æ–‡ä»¶ä¸­ã€‚
å”¯ä¸€éœ€è¦ç¡®ä¿çš„æ˜¯ä»è¿™äº›æ–‡ä»¶ä¸­å¯¼å‡ºæ‰€æœ‰æ¨¡å‹ï¼Œä»¥ä¾¿ Drizzle kit å¯ä»¥å¯¼å…¥å®ƒä»¬å¹¶åœ¨è¿ç§»ä¸­ä½¿ç”¨å®ƒä»¬ã€‚

ä¸€ä¸ªç”¨ä¾‹æ˜¯å°†æ¯ä¸ªè¡¨åˆ†ç¦»åˆ°å®ƒè‡ªå·±çš„æ–‡ä»¶ä¸­ã€‚
```plaintext
ğŸ“¦ <project root>
 â”” ğŸ“‚ src
    â”” ğŸ“‚ db
       â”” ğŸ“‚ schema
          â”œ ğŸ“œ users.ts
          â”œ ğŸ“œ countries.ts
          â”œ ğŸ“œ cities.ts
          â”œ ğŸ“œ products.ts
          â”œ ğŸ“œ clients.ts
          â”” ğŸ“œ etc.ts
```

åœ¨ `drizzle.config.ts` æ–‡ä»¶ä¸­ï¼Œä½ éœ€è¦æŒ‡å®š schema æ–‡ä»¶å¤¹çš„è·¯å¾„ã€‚é€šè¿‡è¿™ä¸ªé…ç½®ï¼ŒDrizzle å°†
é€’å½’è¯»å– `schema` æ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰æ–‡ä»¶ï¼Œå¹¶ä»ä¸­è·å–æ‰€æœ‰ drizzle è¡¨ã€‚æœ‰å…³ `drizzle.config.ts` æ–‡ä»¶
å’Œ Drizzle è¿ç§»çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ï¼š[é“¾æ¥](/docs/drizzle-config-file)

```ts
import { defineConfig } from "drizzle-kit";

export default defineConfig({
  dialect: 'postgresql', // 'mysql' | 'sqlite' | 'turso'
  schema: './src/db/schema'
})
```

ä½ ä¹Ÿå¯ä»¥æŒ‰ç…§ä»»ä½•ä½ å–œæ¬¢çš„æ–¹å¼å¯¹å®ƒä»¬è¿›è¡Œåˆ†ç»„ï¼Œæ¯”å¦‚åˆ›å»ºç”¨æˆ·ç›¸å…³è¡¨ã€æ¶ˆæ¯ç›¸å…³è¡¨ã€äº§å“ç›¸å…³è¡¨ç­‰çš„åˆ†ç»„ã€‚
```plaintext
ğŸ“¦ <project root>
 â”” ğŸ“‚ src
    â”” ğŸ“‚ db
       â”” ğŸ“‚ schema
          â”œ ğŸ“œ users.ts
          â”œ ğŸ“œ messaging.ts
          â”” ğŸ“œ products.ts
```

åœ¨ `drizzle.config.ts` æ–‡ä»¶ä¸­ï¼Œä½ éœ€è¦æŒ‡å®š schema æ–‡ä»¶çš„è·¯å¾„ã€‚é€šè¿‡è¿™ä¸ªé…ç½®ï¼ŒDrizzle å°†
ä» `schema.ts` æ–‡ä»¶ä¸­è¯»å–ä¿¡æ¯ï¼Œå¹¶åœ¨è¿ç§»ç”Ÿæˆè¿‡ç¨‹ä¸­ä½¿ç”¨è¿™äº›ä¿¡æ¯ã€‚æœ‰å…³ `drizzle.config.ts` æ–‡ä»¶
å’Œ Drizzle è¿ç§»çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ï¼š[é“¾æ¥](/docs/drizzle-config-file)

```ts
import { defineConfig } from "drizzle-kit";

export default defineConfig({
  dialect: 'postgresql', // 'mysql' | 'sqlite' | 'turso'
  schema: './src/db/schema'
})
```

## æ„å»ºä½ çš„æ•°æ® schema

Drizzle schema ç”±ä½ ä½¿ç”¨çš„æ•°æ®åº“çš„å‡ ç§æ¨¡å‹ç±»å‹ç»„æˆã€‚ä½¿ç”¨ drizzleï¼Œä½ å¯ä»¥æŒ‡å®šï¼š
- å¸¦æœ‰åˆ—ã€çº¦æŸç­‰çš„è¡¨
- Schemasï¼ˆä»…é™ PostgreSQLï¼‰
- æšä¸¾
- åºåˆ—ï¼ˆä»…é™ PostgreSQLï¼‰
- è§†å›¾
- ç‰©åŒ–è§†å›¾
- ç­‰ç­‰

è®©æˆ‘ä»¬é€ä¸€æŸ¥çœ‹å¦‚ä½•ä½¿ç”¨ drizzle å®šä¹‰ schema

#### **è¡¨å’Œåˆ—çš„å£°æ˜** 

Drizzle ä¸­çš„è¡¨å¿…é¡»è‡³å°‘å®šä¹‰ 1 åˆ—ï¼Œå°±åƒåœ¨æ•°æ®åº“ä¸­åº”è¯¥åšçš„é‚£æ ·ã€‚æœ‰ä¸€ä¸ªé‡è¦çš„äº‹æƒ…éœ€è¦çŸ¥é“ï¼Œ
drizzle ä¸­æ²¡æœ‰é€šç”¨çš„è¡¨å¯¹è±¡ã€‚ä½ éœ€è¦é€‰æ‹©ä½ æ­£åœ¨ä½¿ç”¨çš„æ–¹è¨€ï¼ŒPostgreSQLã€MySQL æˆ– SQLite

![](@/assets/images/table-structure.svg)

<CodeTabs items={["PostgreSQL Table", "MySQL Table", "SQLite Table"]}>
```ts copy
import { pgTable, integer } from "drizzle-orm/pg-core"

export const users = pgTable('users', {
  id: integer()
});
```
```ts copy
import { mysqlTable, int } from "drizzle-orm/mysql-core"

export const users = mysqlTable('users', {
  id: int()
});
```
```ts copy
import { sqliteTable, integer } from "drizzle-orm/sqlite-core"

export const users = sqliteTable('users', {
  id: integer()
});
```
</CodeTabs>

é»˜è®¤æƒ…å†µä¸‹ï¼ŒDrizzle å°†åœ¨æ•°æ®åº“æŸ¥è¯¢ä¸­ä½¿ç”¨ TypeScript é”®åä½œä¸ºåˆ—åã€‚
å› æ­¤ï¼Œç¤ºä¾‹ä¸­çš„ schema å’ŒæŸ¥è¯¢å°†ç”Ÿæˆå¦‚ä¸‹æ‰€ç¤ºçš„ SQL æŸ¥è¯¢

<Callout>
æœ¬ç¤ºä¾‹ä½¿ç”¨ db å¯¹è±¡ï¼Œå…¶åˆå§‹åŒ–æœªåœ¨æœ¬æ–‡æ¡£çš„è¿™éƒ¨åˆ†ä¸­æ¶‰åŠã€‚è¦äº†è§£å¦‚ä½•è¿æ¥åˆ°æ•°æ®åº“ï¼Œè¯·å‚è€ƒ [è¿æ¥æ–‡æ¡£](/docs/get-started-postgresql)
</Callout>

\
**TypeScript é”® = æ•°æ®åº“é”®**
<Section>
```ts
// schema.ts
import { integer, pgTable, varchar } from "drizzle-orm/pg-core";

export const users = pgTable('users', {
  id: integer(),
  first_name: varchar()
})
```
```ts
// query.ts
await db.select().from(users);
```
```sql
SELECT "id", "first_name" from users;
```
</Section>

å¦‚æœä½ æƒ³åœ¨ TypeScript ä»£ç å’Œæ•°æ®åº“ä¸­ä½¿ç”¨ä¸åŒçš„åç§°ï¼Œä½ å¯ä»¥ä½¿ç”¨åˆ—åˆ«å

<Section>
```ts
// schema.ts
import { integer, pgTable, varchar } from "drizzle-orm/pg-core";

export const users = pgTable('users', {
  id: integer(),
  firstName: varchar('first_name')
})
```
```ts
// query.ts
await db.select().from(users);
```
```sql
SELECT "id", "first_name" from users;
```
</Section>

### é©¼å³°å‘½åå’Œä¸‹åˆ’çº¿å‘½å

æ•°æ®åº“æ¨¡å‹åç§°é€šå¸¸ä½¿ç”¨ `snake_case` çº¦å®šï¼Œè€Œåœ¨ TypeScript ä¸­ï¼Œé€šå¸¸ä½¿ç”¨ `camelCase` æ¥å‘½åæ¨¡å‹ã€‚
è¿™å¯èƒ½å¯¼è‡´éœ€è¦åœ¨ schema ä¸­å®šä¹‰å¤§é‡çš„åˆ«åã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒDrizzle æä¾›äº†ä¸€ç§æ–¹æ³•ï¼Œé€šè¿‡åœ¨ Drizzle æ•°æ®åº“åˆå§‹åŒ–æœŸé—´
åŒ…å«ä¸€ä¸ªå¯é€‰å‚æ•°ï¼Œè‡ªåŠ¨å°† TypeScript ä¸­çš„ `camelCase` æ˜ å°„åˆ°æ•°æ®åº“ä¸­çš„ `snake_case`ã€‚

å¯¹äºè¿™ç§æ˜ å°„ï¼Œä½ å¯ä»¥åœ¨ Drizzle DB å£°æ˜ä¸­ä½¿ç”¨ `casing` é€‰é¡¹ã€‚è¿™ä¸ªå‚æ•°å°†
å¸®åŠ©ä½ æŒ‡å®šæ•°æ®åº“æ¨¡å‹å‘½åçº¦å®šï¼Œå¹¶å°è¯•ç›¸åº”åœ°æ˜ å°„æ‰€æœ‰ JavaScript é”®

<Section>
```ts
// schema.ts
import { drizzle } from "drizzle-orm/node-postgres";
import { integer, pgTable, varchar } from "drizzle-orm/pg-core";

export const users = pgTable('users', {
  id: integer(),
  firstName: varchar()
})
```
```ts
// db.ts
const db = drizzle({ connection: process.env.DATABASE_URL, casing: 'snake_case' })
```
```ts
// query.ts
await db.select().from(users);
```
```sql
SELECT "id", "first_name" from users;
```
</Section>

### é«˜çº§ç”¨æ³•

ä½ å¯ä»¥åœ¨ Drizzle ORM ä¸­ä½¿ç”¨ä¸€äº›æŠ€å·§ã€‚ç”±äº Drizzle å®Œå…¨åœ¨ TypeScript æ–‡ä»¶ä¸­ï¼Œ
ä½ åŸºæœ¬ä¸Šå¯ä»¥åƒåœ¨ç®€å•çš„ TypeScript é¡¹ç›®ä¸­é‚£æ ·å¤„ç†ä½ çš„ä»£ç ã€‚

ä¸€ä¸ªå¸¸è§çš„åŠŸèƒ½æ˜¯å°†åˆ—åˆ†ç¦»åˆ°ä¸åŒçš„ä½ç½®ï¼Œç„¶åé‡ç”¨å®ƒä»¬ã€‚
ä¾‹å¦‚ï¼Œè€ƒè™‘ `updated_at`ã€`created_at` å’Œ `deleted_at` åˆ—ã€‚è®¸å¤šè¡¨/æ¨¡å‹å¯èƒ½éœ€è¦è¿™äº›
ä¸‰ä¸ªå­—æ®µæ¥è·Ÿè¸ªå’Œåˆ†æç³»ç»Ÿä¸­å®ä½“çš„åˆ›å»ºã€åˆ é™¤å’Œæ›´æ–°

æˆ‘ä»¬å¯ä»¥åœ¨å•ç‹¬çš„æ–‡ä»¶ä¸­å®šä¹‰è¿™äº›åˆ—ï¼Œç„¶åå¯¼å…¥å¹¶å°†å®ƒä»¬åˆ†æ•£åˆ°ä½ æ‹¥æœ‰çš„æ‰€æœ‰è¡¨å¯¹è±¡ä¸­

<Section>
```ts
// columns.helpers.ts
const timestamps = {
  updated_at: timestamp(),
  created_at: timestamp().defaultNow().notNull(),
  deleted_at: timestamp(),
}
```
```ts
// users.sql.ts
export const users = pgTable('users', {
  id: integer(),
  ...timestamps
})
```
```ts
// posts.sql.ts
export const posts = pgTable('posts', {
  id: integer(),
  ...timestamps
})
```
</Section>

#### **Schemas**

<Tabs items={['PostgreSQL', 'MySQL', 'SQLite']}>
<Tab>
\
PostgreSQL ä¸­æœ‰ä¸€ä¸ªå«åš `schema` çš„å®ä½“ï¼ˆæˆ‘ä»¬è®¤ä¸ºåº”è¯¥å«åš `folders`ï¼‰ã€‚è¿™åœ¨ PostgreSQL ä¸­åˆ›å»ºäº†ä¸€ä¸ªç»“æ„ï¼š

![](@/assets/images/postgresql-db-structure.png)

ä½ å¯ä»¥ä½¿ç”¨ `pgSchema` ç®¡ç†ä½ çš„ PostgreSQL schemasï¼Œå¹¶åœ¨å…¶ä¸­æ”¾ç½®ä»»ä½•å…¶ä»–æ¨¡å‹ã€‚

ä½¿ç”¨ Drizzle å®šä¹‰ä½ æƒ³è¦ç®¡ç†çš„ schema
```ts
import { pgSchema } from "drizzle-orm/pg-core"

export const customSchema = pgSchema('custom');
```

ç„¶åå°†è¡¨æ”¾åœ¨ schema å¯¹è±¡ä¸­
```ts {5-7}
import { integer, pgSchema } from "drizzle-orm/pg-core";

export const customSchema = pgSchema('custom');

export const users = customSchema.table('users', {
  id: integer()
})
```
</Tab>
<Tab>
\
MySQL ä¸­æœ‰ä¸€ä¸ªå«åš `Schema` çš„å®ä½“ï¼Œä½†åœ¨ MySQL æœ¯è¯­ä¸­ï¼Œè¿™ç›¸å½“äºä¸€ä¸ª `Database`ã€‚

ä½ å¯ä»¥ä½¿ç”¨ `drizzle-orm` å®šä¹‰å®ƒä»¬å¹¶åœ¨æŸ¥è¯¢ä¸­ä½¿ç”¨å®ƒä»¬ï¼Œä½†å®ƒä»¬ä¸ä¼šè¢« `drizzle-kit` æ£€æµ‹åˆ°æˆ–åŒ…å«åœ¨è¿ç§»æµç¨‹ä¸­

![](@/assets/images/mysql-db-structure.png)

ä½¿ç”¨ Drizzle å®šä¹‰ä½ æƒ³è¦ç®¡ç†çš„ schema
```ts
import { mysqlSchema } from "drizzle-orm/mysql-core"

export const customSchema = mysqlSchema('custom');
```

ç„¶åå°†è¡¨æ”¾åœ¨ schema å¯¹è±¡ä¸­
```ts {5-7}
import { int, mysqlSchema } from "drizzle-orm/mysql-core";

export const customSchema = mysqlSchema('custom');

export const users = customSchema.table('users', {
  id: int()
})
```
</Tab>
<Tab>
\
SQLite ä¸­æ²¡æœ‰ schema çš„æ¦‚å¿µï¼Œæ‰€ä»¥ä½ åªèƒ½åœ¨å•ä¸ª SQLite æ–‡ä»¶ä¸Šä¸‹æ–‡ä¸­å®šä¹‰è¡¨

![](@/assets/images/sqlite-db-structure.png)
</Tab>
</Tabs>

### ç¤ºä¾‹

ä¸€æ—¦ä½ äº†è§£äº†åŸºç¡€çŸ¥è¯†ï¼Œè®©æˆ‘ä»¬ä¸ºä¸€ä¸ªçœŸå®é¡¹ç›®å®šä¹‰ä¸€ä¸ª schema ç¤ºä¾‹ï¼Œä»¥è·å¾—æ›´å¥½çš„è§†å›¾å’Œç†è§£

> æ‰€æœ‰ç¤ºä¾‹éƒ½å°†ä½¿ç”¨ `generateUniqueString`ã€‚å…¶å®ç°å°†åœ¨æ‰€æœ‰ schema ç¤ºä¾‹ä¹‹åæä¾›

<CodeTabs items={['PostgreSQL', 'MySQL', 'SQLite']}>
```ts copy
import { AnyPgColumn } from "drizzle-orm/pg-core";
import { pgEnum, pgTable as table } from "drizzle-orm/pg-core";
import * as t from "drizzle-orm/pg-core";

export const rolesEnum = pgEnum("roles", ["guest", "user", "admin"]);

export const users = table(
  "users",
  {
    id: t.integer().primaryKey().generatedAlwaysAsIdentity(),
    firstName: t.varchar("first_name", { length: 256 }),
    lastName: t.varchar("last_name", { length: 256 }),
    email: t.varchar().notNull(),
    invitee: t.integer().references((): AnyPgColumn => users.id),
    role: rolesEnum().default("guest"),
  },
  (table) => [
    t.uniqueIndex("email_idx").on(table.email)
  ]
);

export const posts = table(
  "posts",
  {
    id: t.integer().primaryKey().generatedAlwaysAsIdentity(),
    slug: t.varchar().$default(() => generateUniqueString(16)),
    title: t.varchar({ length: 256 }),
    ownerId: t.integer("owner_id").references(() => users.id),
  },
  (table) => [
    t.uniqueIndex("slug_idx").on(table.slug),
    t.index("title_idx").on(table.title),
  ]
);

export const comments = table("comments", {
  id: t.integer().primaryKey().generatedAlwaysAsIdentity(),
  text: t.varchar({ length: 256 }),
  postId: t.integer("post_id").references(() => posts.id),
  ownerId: t.integer("owner_id").references(() => users.id),
});
```
```ts copy
import { mysqlTable as table } from "drizzle-orm/mysql-core";
import * as t from "drizzle-orm/mysql-core";
import { AnyMySqlColumn } from "drizzle-orm/mysql-core";

export const users = table(
  "users",
  {
    id: t.int().primaryKey().autoincrement(),
    firstName: t.varchar("first_name", { length: 256 }),
    lastName: t.varchar("last_name", { length: 256 }),
    email: t.varchar({ length: 256 }).notNull(),
    invitee: t.int().references((): AnyMySqlColumn => users.id),
    role: t.mysqlEnum(["guest", "user", "admin"]).default("guest"),
  },
  (table) => [
    t.uniqueIndex("email_idx").on(table.email)
  ]
);

export const posts = table(
  "posts",
  {
    id: t.int().primaryKey().autoincrement(),
    slug: t.varchar({ length: 256 }).$default(() => generateUniqueString(16)),
    title: t.varchar({ length: 256 }),
    ownerId: t.int("owner_id").references(() => users.id),
  },
  (table) => [
    t.uniqueIndex("slug_idx").on(table.slug),
    t.index("title_idx").on(table.title),
  ]
);

export const comments = table("comments", {
  id: t.int().primaryKey().autoincrement(),
  text: t.varchar({ length: 256 }),
  postId: t.int("post_id").references(() => posts.id),
  ownerId: t.int("owner_id").references(() => users.id),
});
```
```ts copy
import { sqliteTable as table } from "drizzle-orm/sqlite-core";
import * as t from "drizzle-orm/sqlite-core";
import { AnySQLiteColumn } from "drizzle-orm/sqlite-core";

export const users = table(
  "users",
  {
    id: t.int().primaryKey({ autoIncrement: true }),
    firstName: t.text("first_name"),
    lastName: t.text("last_name"),
    email: t.text().notNull(),
    invitee: t.int().references((): AnySQLiteColumn => users.id),
    role: t.text().$type<"guest" | "user" | "admin">().default("guest"),
  },
  (table) => [
    t.uniqueIndex("email_idx").on(table.email)
  ]
);

export const posts = table(
  "posts",
  {
    id: t.int().primaryKey({ autoIncrement: true }),
    slug: t.text().$default(() => generateUniqueString(16)),
    title: t.text(),
    ownerId: t.int("owner_id").references(() => users.id),
  },
  (table) => [
    t.uniqueIndex("slug_idx").on(table.slug),
    t.index("title_idx").on(table.title),
  ]
);

export const comments = table("comments", {
  id: t.int().primaryKey({ autoIncrement: true }),
  text: t.text({ length: 256 }),
  postId: t.int("post_id").references(() => posts.id),
  ownerId: t.int("owner_id").references(() => users.id),
});
```
</CodeTabs>

**`generateUniqueString` å®ç°ï¼š**
```ts
function generateUniqueString(length: number = 12): string {
  const characters =
    "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
  let uniqueString = "";

  for (let i = 0; i < length; i++) {
    const randomIndex = Math.floor(Math.random() * characters.length);
    uniqueString += characters[randomIndex];
  }

  return uniqueString;
}
```


#### ä¸‹ä¸€æ­¥ï¼Ÿ
<br/>
<Flex>
  <LinksList 
    title='ç®¡ç† schema'
    links={[
        ["åˆ—ç±»å‹", "/docs/column-types/pg"], 
        ["ç´¢å¼•å’Œçº¦æŸ", "/docs/indexes-constraints"],
        ["æ•°æ®åº“è§†å›¾", "/docs/views"],
        ["æ•°æ®åº“ Schemas", "/docs/schemas"],
        ["åºåˆ—", "/docs/sequences"],
        ["æ‰©å±•", "/docs/extensions/pg"],
      ]}
  />
  <LinksList 
    title='ä»é›¶åˆ°è‹±é›„'
    links={[
        ["æ•°æ®åº“è¿æ¥", "/docs/connect-overview"], 
        ["æ•°æ®æŸ¥è¯¢", "/docs/data-querying"], 
        ["è¿ç§»", "/docs/migrations"], 
      ]}
  />
</Flex>
